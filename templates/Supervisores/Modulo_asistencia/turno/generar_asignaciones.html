{% extends "central_user.html" %}
{% block content %}
<div class="container py-4">
  <h2 class="h4 text-primary mb-4">
    <i class="fas fa-calendar-plus me-2"></i>
    Generar Asignaciones para {{ usuario.get_full_name }}
  </h2>
  <form method="post">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div class="mb-3">
      {{ form.fecha_inicio.label_tag }}
      {{ form.fecha_inicio }}
      {{ form.fecha_inicio.errors }}
    </div>
    <div class="mb-3">
      {{ form.fecha_fin.label_tag }}
      {{ form.fecha_fin }}
      {{ form.fecha_fin.errors }}
    </div>
    <div class="mb-3">
      {{ form.tipo_rotacion.label_tag }}
      {{ form.tipo_rotacion }}
      {{ form.tipo_rotacion.errors }}
    </div>
    <div class="mb-3">
      {{ form.horarios.label_tag }}
      {{ form.horarios }}
      {{ form.horarios.errors }}
      <small class="form-text text-muted">{{ form.horarios.help_text }}</small>
    </div>
    <!-- Campos para 7x7 -->
    <div class="mb-3" id="campos_7x7" style="display: none;">
      {{ form.horario_semana_1.label_tag }}
      {{ form.horario_semana_1 }}
      {{ form.horario_semana_1.errors }}
      <small class="form-text text-muted">{{ form.horario_semana_1.help_text }}</small>
      {{ form.horario_semana_2.label_tag }}
      {{ form.horario_semana_2 }}
      {{ form.horario_semana_2.errors }}
      <small class="form-text text-muted">{{ form.horario_semana_2.help_text }}</small>
    </div>
    <!-- Campos para rotaciÃ³n personalizada -->
    <div class="mb-3" id="campos_personalizado" style="display: none;">
      {{ form.secuencia.label_tag }}
      {{ form.secuencia }}
      {{ form.secuencia.errors }}
      <small class="form-text text-muted">{{ form.secuencia.help_text }}</small>
      {{ form.repeticion.label_tag }}
      {{ form.repeticion }}
      {{ form.repeticion.errors }}
      <small class="form-text text-muted">{{ form.repeticion.help_text }}</small>
    </div>
    <div class="d-flex justify-content-between">
      <a href="{% url 'calendario_turno' user_id=usuario.id %}" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left me-2"></i>Cancelar
      </a>
      <button type="submit" class="btn btn-primary">
        <i class="fas fa-save me-2"></i>Generar Asignaciones
      </button>
    </div>
  </form>
</div>
<script>
document.getElementById('id_tipo_rotacion').addEventListener('change', function() {
  const campos7x7 = document.getElementById('campos_7x7');
  const camposPersonalizado = document.getElementById('campos_personalizado');
  if (this.value === '7x7') {
    campos7x7.style.display = 'block';
    camposPersonalizado.style.display = 'none';
  } else if (this.value === 'personalizado') {
    campos7x7.style.display = 'none';
    camposPersonalizado.style.display = 'block';
  } else {
    campos7x7.style.display = 'none';
    camposPersonalizado.style.display = 'none';
  }
});
</script>
{% endblock %}